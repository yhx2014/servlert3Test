<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>表行列固定</title>

<style>
body,html,table {
	margin: 0;
	padding: 0;
}

.LockRow /*固定行的样式*/ {
	position: relative;
	/* 	top: expression(this.parentElement.parentElement.parentElement.scrollTop); */
	/*top:0px;*/
	z-index: 2;
}

.LockCell /*固定列的样式*/ {
	position: relative;
	/* 	left: expression(this.parentElement.parentElement.parentElement.parentElement.scrollLeft */
	/* 		); */
	/*left:0px;*/
	z-index: 0;
}

.LockCross /*行列交叉处样式*/ {
	z-index: 3;
	background-color: #9AD8D8;
}

.divBoxing /*外出div样式*/ {
	clear: both;
	overflow: scroll;
	position: relative;
}

.tbLock /*设置单元格间隙的样式*/ {
	border-collapse: collapse;
}

.lockRowBg {
	background-color: #CFF;
}

.lockColumnBg {
	background-color: #CFF;
}

table td{
height: 40px;
font-weight: bold;
}
table th{
height: 100px;
border:#CCCCCC 1px solid;
}
</style>
</head>

<body>
	<div id="scrollDiv" name="DIV"
		style="overflow: auto; height: 300px; width: 700px; cursor: default; display: inline; position: absolute;">
		<table width="900px" border="0" id="lockTable" class="tbLock">
			<tbody>
				<tr class="">
					<td align="center">第一列</td>
					<td align="center">第二列</td>
					<td align="center">第三列</td>
					<td align="center">第四列</td>
					<td align="center">第五列</td>
					<td align="center">第六列</td>
					<td align="center">第七列</td>
					<td align="center">第八列</td>
					<td align="center">第九列</td>
					<td align="center">第十列</td>
					<td align="center">十一列</td>
					<td align="center">十二列</td>
					<td align="center">十三列</td>
					<td align="center">十四列</td>
					<td align="center">十五列</td>
					<td align="center">十六列</td>
					<td align="center">十七列</td>
					<td align="center">十八列</td>
					<td align="center">十九列</td>
					<td align="center">二十列</td>
				</tr>
				<tr>
					<td align="center">1-2</td>
					<td align="center">2-2</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>

					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
				</tr>
				<tr>
					<td align="center" >1-3</td>
					<td align="center" >2-3</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>

					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>

				</tr>
				<tr>
					<td align="center" >1-4</td>
					<td align="center" >2-4</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
				</tr>
				<tr>
					<td align="center" >1-5</td>
					<td align="center" >2-5</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
				</tr>
				<tr>
					<td align="center" >1-6</td>
					<td align="center" >2-6</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
				</tr>
				<tr>
					<td align="center" >1-7</td>
					<td align="center" >2-7</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
				</tr>
				<tr>
					<td align="center" >1-8</td>
					<td align="center" >2-8</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
				</tr>
				<tr>
					<td align="center" >1-9</td>
					<td align="center" >2-9</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
				</tr>
				<tr>
					<td align="center" >1-10</td>
					<td align="center" >2-10</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
					<td align="center">--</td>
				</tr>
			</tbody>
		</table>
	</div>

</body>
<script type="text/javascript">
	var Sys = {};

	var ua = navigator.userAgent.toLowerCase();

	var s;

	(s = ua.match(/msie ([\d.]+)/)) ? Sys.ie = s[1] :

	(s = ua.match(/firefox\/([\d.]+)/)) ? Sys.firefox = s[1] :

	(s = ua.match(/chrome\/([\d.]+)/)) ? Sys.chrome = s[1] :

	(s = ua.match(/opera.([\d.]+)/)) ? Sys.opera = s[1] :

	(s = ua.match(/version\/([\d.]+).*safari/)) ? Sys.safari = s[1] : 0;

	function drawTable(scrTable, newTable, iStart, iEnd, jEnd,lockTRclass,lockTDclass) {
		var i, j, k = 0, newTR, newTD, intWidth = 0, intHeight = 0;
		mergeAttributes(scrTable, newTable);
		for (i = iStart; i < iEnd; i++) {
			newTR = newTable.insertRow(k)
			mergeAttributes(scrTable.rows[i], newTR);
			intHeight += scrTable.rows[i].offsetHeight;
			intWidth = 0;
			for (j = 0; j < (jEnd == -1 ? scrTable.rows[i].cells.length : jEnd); j++) {
				newTD = scrTable.rows[i].cells[j].cloneNode(true);
				intWidth += scrTable.rows[i].cells[j].offsetWidth;
				newTR.insertBefore(newTD, null);
				newTD.style.width = scrTable.rows[i].cells[j].offsetWidth;
			
				newTR.setAttribute("class",lockTRclass ); 
				newTD.setAttribute("class",lockTDclass ); 
			}
			k++
		}
		newTable.style.width = intWidth + "px";
		newTable.style.height = intHeight + "px";
	}

	function LockTable(arTable, ColNum, RowHead) {
		arTable.HeadRow = RowHead;
		var objDivMaster = arTable.parentElement;
		var lockTRclass = "LockRow lockRowBg";
		var lockTDclass = "LockCell lockColumnBg";
		if (objDivMaster.tagName != 'DIV')
			return;
		if ((arTable.offsetHeight > objDivMaster.offsetHeight)
				&& (arTable.offsetWidth > objDivMaster.offsetWidth)) {
			if ((ColNum > 0) && (RowHead > 0)) {
				var objTableLH = document.createElement("TABLE");
				var newTBody = document.createElement("TBODY");
				objTableLH.insertBefore(newTBody, null);
				objTableLH.id = "objTableLH";
				objDivMaster.parentElement.insertBefore(objTableLH, null);
				drawTable(arTable, objTableLH, 0, RowHead, ColNum,lockTRclass,"LockCross " + lockTDclass)
				objTableLH.srcTable = arTable;
				objTableLH.style.zIndex = 804;
				objTableLH.style.position = 'absolute';
				objTableLH.style.left = objDivMaster.offsetLeft;
				objTableLH.style.top = objDivMaster.offsetTop;

			}
		}

		if ((RowHead > 0) && (arTable.offsetHeight > objDivMaster.offsetHeight)) {
			var DivHead = document.createElement("DIV");
			objDivMaster.parentElement.insertBefore(DivHead, null);
			var objTableHead = document.createElement("TABLE");
			var newTBody = document.createElement("TBODY");
			objTableHead.id = "HeadTar";
			objTableHead.style.position = "relative"
			objTableHead.insertBefore(newTBody, null);
			DivHead.insertBefore(objTableHead, null);
			drawTable(arTable, objTableHead, 0, RowHead, -1,lockTRclass,"")
			HeadTar.srcTable = arTable;

			DivHead.style.overflow = "hidden";
			DivHead.style.zIndex = 802;
			DivHead.style.width = objDivMaster.offsetWidth - 16 + "px";
			DivHead.style.position = 'absolute';
			DivHead.style.left = objDivMaster.offsetLeft;
			DivHead.style.top = objDivMaster.offsetTop;
			addEvent(objDivMaster, "scroll", divScroll1);
		}

		if ((ColNum > 0) && (arTable.offsetWidth > objDivMaster.offsetWidth)) {
			var DivLeft = document.createElement("DIV");
			objDivMaster.parentElement.insertBefore(DivLeft, null);
			var objTableLeft = document.createElement("TABLE");
			var newTBody = document.createElement("TBODY");
			objTableLeft.insertBefore(newTBody, null);
			objTableLeft.id = "LeftTar";
			objTableLeft.style.position = "relative";
			DivLeft.insertBefore(objTableLeft, null);
			drawTable(arTable, objTableLeft, 0, arTable.rows.length, ColNum,"",lockTDclass)
			LeftTar.srcTable = arTable;

			DivLeft.style.overflow = "hidden";
			DivLeft.style.zIndex = 800;
			DivLeft.style.width = objDivMaster.offsetWidth - 16 + "px";
			DivLeft.style.height = objDivMaster.offsetHeight - 16 + "px";
			DivLeft.style.position = 'absolute';
			DivLeft.style.left = objDivMaster.offsetLeft;
			DivLeft.style.top = objDivMaster.offsetTop;
			addEvent(objDivMaster, "scroll", divScroll2);
		}
	}

	function divScroll1() {
		var tbl = document.all('HeadTar').srcTable, parDiv = tbl.parentElement;

		while (parDiv.tagName != 'DIV')
			parDiv = parDiv.parentElement;
		window.status = -parDiv.scrollLeft
		document.all('HeadTar').style.left = -parDiv.scrollLeft + "px";
	}

	function divScroll2() {
		var tbl = document.all('LeftTar').srcTable, parDiv = tbl.parentElement;
		while (parDiv.tagName != 'DIV')
			parDiv = parDiv.parentElement;
		window.status = -parDiv.scrollLeft
		document.all('LeftTar').style.top = -parDiv.scrollTop + "px";
	}

	function addEvent(obj, event, func) {
		if (Sys.ie) {
			obj.attachEvent("on" + event, func);
			return;
		}

		if (Sys.chrome || Sys.firefox) {
			obj.addEventListener(event, func)
			return;
		}
	}

	function mergeAttributes(o1, o2) {
		if (Sys.ie) {
			o2.mergeAttributes(o1)
			return;
		}

		if (Sys.chrome || Sys.firefox) {

		}

		//       if (Sys.opera) document.write('Opera: ' + Sys.opera);

		//        if (Sys.safari) document.write('Safari: ' + Sys.safari);

		if (o1 && o2) {
			var srcAttrs = o1.attributes;

			for ( var tmp in srcAttrs) {
				var name = srcAttrs[tmp].nodeName;
				var value = srcAttrs[tmp].value;

				if (name && value) {
					if (!o2.getAttribute(name)) {
						o2.setAttribute(name, value);
					}
				}
			}

		}
	}

	var table = document.getElementById("lockTable");
	LockTable(table, 2, 1);
</script>

</html>
